<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.egemmerce.hc.repository.mapper.UserAddressMapper">

<!-- C :: 배송지 추가 -->
<insert id="insertAddress">
	insert into user_address
		(ua_name, ua_u_no, ua_alias, ua_lnm_address, ua_rn_address, ua_zip_code, ua_default_setting)
	values
		(#{uaName}, #{uaUNo}, #{uaAlias}, #{uaLnmAddress}, #{uaRnAddress}, #{uaZipCode})
</insert>

<!-- R :: 내 배송지 전체조회 -->
<select id="selectAddressMine" parameterType="int">
	select *
	  from user_address
	 where ua_u_no = #{uNo}
</select>

<!-- U :: 배송지 업데이트(기본배송지) -->
<update id="updateDefaultAddress">
	update user_address 
	set 
		ua_default_setting = 
			case when ua_default_setting="true"  
			then "false"
		when ua_no = (select ua_no from user_address where ua_default_setting="true")  then "true"
		where ua_u_no = #{uaUNo}
</update>

<!-- U :: 배송지 업데이트(배송지명 혹은 주소지) -->
<update id="updateUserAddressEdit">
	update user_address
	   set ua_name = #{uaName}, ua_alias=#{uaAlias}, ua_lnm_address=#{uaLnmAddress}, ua_rn_address=#{uaRnAddress}, #ua_zip_code=#{uaZipCode}
	 where ua_u_no = #{uaUNo}
</update>

<!-- D :: 배송지 삭제 -->
<delete id="deleteUserAddress" parameterType="int">
delete
  from user_address
 where ua_no=#{uaNo}
</delete>

</mapper>